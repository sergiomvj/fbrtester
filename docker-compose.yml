version: '3.8'

services:
  agent:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: 8tester-agent
    volumes:
      - ./dashboard/public:/app/dashboard/public # Share report with dashboard
      - ./.env:/app/.env
    environment:
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
      - SUPABASE_URL=${SUPABASE_URL}
      - SUPABASE_KEY=${SUPABASE_KEY}
    networks:
      - 8tester-network

  dashboard:
    build:
      context: ./dashboard
      dockerfile: Dockerfile
    container_name: 8tester-dashboard
    ports:
      - "3000:3000"
    volumes:
      - ./dashboard/public:/app/public # Read shared report
    environment:
      - NODE_ENV=production
    networks:
      - 8tester-network

networks:
  8tester-network:
    driver: bridge
